const Count={generateInterval:0,data:{},init:function(){var t=JSON.parse(localStorage.getItem("count"))||{};t.time=t.time||"1800",t.lunch=t.lunch||"1130",t.salary=t.salary||"365",t.startTime=t.startTime||"0900",this.data=t,this.save(),"disabled"!==t.status&&(this.initHtml(),this.start())},initHtml:function(){const t=document.createElement("div"),o=this.data;t.id="timeContent",o.left&&o.top&&document.documentElement.clientHeight>o.top&&document.documentElement.clientWidth>o.left&&t.setAttribute("style","left:"+o.left+"px;top:"+o.top+"px;"),t.innerHTML="<a class='time_box' id='countRemainBox'><span id='countRemain'></span></a>",document.body.insertBefore(t,document.body.firstChild);let s=document.getElementById("timeContent");s.onmousedown=t=>{let n=t.clientX-s.offsetLeft,a=t.clientY-s.offsetTop,i,l;document.onmousemove=function(t){var e=t.clientX-n,t=t.clientY-a;i=e,l=t,o.left=e,o.top=t,Count.data=o,Count.save(),0<=e&&e<=window.innerWidth-s.offsetWidth&&(s.style.left=e+"px"),0<=t&&t<=window.innerHeight-s.offsetHeight&&(s.style.top=t+"px")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,void 0===i&&void 0===l&&Count.settings()}}},generate:function(){var t=(new Date).getFullYear()+`-${("0"+((new Date).getMonth()+1)).slice(-2)}-`+("0"+(new Date).getDate()).slice(-2),e=Count.data.time.match(/\d{2}/g),e=new Date(t+` ${e[0]}:${e[1]}:00`),n=new Date,a=Count.data.lunch.match(/\d{2}/g),a=new Date(t+` ${a[0]}:${a[1]}:00`).getTime()-n.getTime();let i=Math.floor(a/36e5%24),l=Math.floor(a/6e4%60),o=Math.floor(a/1e3%60),s=!1;0===i&&0<=l&&0<=o&&(i=("0"+i).slice(-2),l=("0"+l).slice(-2),o=("0"+o).slice(-2),a=i+":"+l+":"+o,"00"===i&&"00"===l&&"00"===o&&Util.notice("success",3e4,"ä¸­åˆå’¯ï¼Œè¯¥åƒé¥­å•¦ï½"),document.getElementById("countRemainBox").innerHTML="åˆé¥­ğŸ²<br><span id='countRemain'>"+a+"</span>",s=!0);var a=e.getTime()-n.getTime(),e=Math.floor(a/36e5%24),n=Math.floor(a/6e4%60),d=Math.floor(a/1e3%60);0<=e&&0<=n&&0<=d&&!s?(a=(e=("0"+e).slice(-2))+":"+(n=("0"+n).slice(-2))+":"+(d=("0"+d).slice(-2)),"00"===e&&"02"===n&&"00"===d&&Util.notice("danger",3e4,"é©¬ä¸Šå°±è¦ä¸‹ç­å•¦ï¼Œèµ¶å¿«æ”¶æ‹¾æ”¶æ‹¾å§ï½"),"00"===e&&"00"===n&&"00"===d&&Util.notice("success",3e4,"ä¸‹ç­å•¦ï¼ä»Šå¤©ä½ èµšäº†ï¿¥"+Count.data.salary+"ï¼"),e=Count.data.salary,n=Count.data.startTime.match(/\d{2}/g),d=Count.data.time.match(/\d{2}/g),n=new Date(t+` ${n[0]}:${n[1]}:00`),t=new Date(t+` ${d[0]}:${d[1]}:00`).getTime()-n.getTime(),d=e/(60*Math.floor(t/36e5%24)*60+60*Math.floor(t/6e4%60)+Math.floor(t/1e3%60))/1e3,t=((e=(new Date).getTime()-n.getTime())*d).toFixed(3),console.log(e),document.getElementById("countRemainBox").innerHTML="<span id='countRemain'>"+a+"</span><span id='countSalary'>ï¿¥"+t+"</span>"):i<0&&l<0&&o<0&&(document.getElementById("countRemainBox").innerText="ä¸‹ç­ğŸ‰\nä»Šæ—¥æ”¶å…¥\nï¿¥"+Count.data.salary,clearInterval(Count.generateInterval))},start:function(){Count.generate(),Count.generateInterval=setInterval(function(){Count.generate()},100)},save:function(){/^\d+$/.test(this.data.salary)||(this.data.salary=365),localStorage.setItem("count",JSON.stringify(this.data))},settings:function(){Util.alert(`<div class="form fn__flex-column" style="width: 100%;border:none;box-shadow:none;background:none;">
<label>
  <div class="ft__smaller ft__fade" style="float: left">çŠ¶æ€ï¼ˆå…³é—­åå¯ç‚¹å‡»å³ä¸Šè§’å¤´åƒæ‰¾åˆ°ä¸‹ç­å€’è®¡æ—¶è®¾å®šï¼‰</div>
  <div class="fn-hr5 fn__5"></div>
  <select id="countSettingStatus">
  <option value="enabled" selected>å¼€å¯</option>  <option value="disabled">å…³é—­</option>  </select>
</label>
<label>
  <div class="ft__smaller ft__fade">ä¸Šç­æ—¶é—´ (ç”¨äºè®¡ç®—æ—¥è–ª)</div>
  <div class="fn-hr5 fn__5"></div>
  <input id="countSettingsStartTime" type="time"/>
</label>
<label>
  <div class="ft__smaller ft__fade">ä¸‹ç­æ—¶é—´</div>
  <div class="fn-hr5 fn__5"></div>
  <input id="countSettingsTime" type="time"/>
</label>
<label>
  <div class="ft__smaller ft__fade">åˆé¥­æ—¶é—´</div>
  <div class="fn-hr5 fn__5"></div>
  <input id="lunchSettingsTime" type="time"/>
</label>
<label>
  <div class="ft__smaller ft__fade">ä½ çš„æ—¥è–ª (è®¾ç½®0ä¸ºåˆ™ä¸æ˜¾ç¤º)</div>
  <div class="fn-hr5 fn__5"></div>
  <input id="salarySetting" type="text"/>
</label>
<div class="fn-hr5"></div>
<div class="fn__flex" style="margin-top: 15px">
<div class="fn__flex-1 fn__flex-center" style="text-align: left;"></div>
  <button class="btn btn--confirm" onclick='Count.saveSettings()'>ä¿å­˜</button>
</div>
</div>`,"ä¸‹ç­å€’è®¡æ—¶è®¾å®š"),setTimeout(function(){var t=Count.data.time.match(/\d{2}/g),t=(document.getElementById("countSettingsTime").value=t[0]+":"+t[1],Count.data.startTime.match(/\d{2}/g)),t=(document.getElementById("countSettingsStartTime").value=t[0]+":"+t[1],Count.data.lunch.match(/\d{2}/g));document.getElementById("lunchSettingsTime").value=t[0]+":"+t[1],document.getElementById("salarySetting").value=Count.data.salary,document.getElementById("countSettingStatus").value="disabled"===Count.data.status?"disabled":"enabled"},500)},saveSettings:function(){Count.data.time=document.getElementById("countSettingsTime").value.replace(":",""),Count.data.lunch=document.getElementById("lunchSettingsTime").value.replace(":",""),Count.data.startTime=document.getElementById("countSettingsStartTime").value.replace(":",""),Count.data.salary=document.getElementById("salarySetting").value,Count.data.status=document.getElementById("countSettingStatus").value,Count.save(),Util.closeAlert(),location.reload()}};$(document).ready(function(){Count.init()});